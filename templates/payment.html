<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bite Mate</title>
    <link rel="stylesheet" href="../static/css/payement.css" type="text/css"/>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
        crossorigin="anonymous">
  </head>
  <body>
  <!--Header-->

    <header class="primary-header">
      <div class="container">
        <div class="nav-wrapper">
          <button class="button1">
            <span>BITE MATE</span>
          </button>
          <table style="width: 450px;">
            <tr>
              <td><a href="#">Home</a></td>
              <td><a href="#">Restaurants</a></td>
              <td><a href="#search">Search</a></td>
              <td><a href="#about">About</a></td>
              <td><a href="#contact">Contact</a></td>
              <td><a href="#">Profile</a></td>
            </tr>
            <tr>
              <td><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-house-fill" viewBox="0 0 16 16">
                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.707 1.5Z"/>
                <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293l6-6Z"/>
              </svg></a></td>
              <td><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-truck" viewBox="0 0 16 16">
                <path d="M0 3.5A1.5 1.5 0 0 1 1.5 2h9A1.5 1.5 0 0 1 12 3.5V5h1.02a1.5 1.5 0 0 1 1.17.563l1.481 1.85a1.5 1.5 0 0 1 .329.938V10.5a1.5 1.5 0 0 1-1.5 1.5H14a2 2 0 1 1-4 0H5a2 2 0 1 1-3.998-.085A1.5 1.5 0 0 1 0 10.5v-7zm1.294 7.456A1.999 1.999 0 0 1 4.732 11h5.536a2.01 2.01 0 0 1 .732-.732V3.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .294.456zM12 10a2 2 0 0 1 1.732 1h.768a.5.5 0 0 0 .5-.5V8.35a.5.5 0 0 0-.11-.312l-1.48-1.85A.5.5 0 0 0 13.02 6H12v4zm-9 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm9 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
              </svg></a></td>
              <td><a href="#search"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
              </svg></a></td>
              <td><a href="#about"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-file-person-fill" viewBox="0 0 16 16">
                <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm-1 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm-3 4c2.623 0 4.146.826 5 1.755V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-1.245C3.854 11.825 5.377 11 8 11z"/>
              </svg></a></td>
              <td><a href="#contact"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-person-lines-fill" viewBox="0 0 16 16">
                <path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2z"/>
              </svg></a></td>
              <td><a href="../login.html"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-box-arrow-in-right" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M6 3.5a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 0-1 0v2A1.5 1.5 0 0 0 6.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-8A1.5 1.5 0 0 0 5 3.5v2a.5.5 0 0 0 1 0v-2z"/>
                <path fill-rule="evenodd" d="M11.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H1.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
              </svg></a></td>
            </tr>
          </table>
          <form action="#" method="get">
            <span class=""><input
              class="form-header"
              id="search"
              type="text"
              name="search"
              placeholder="Search"
            /></span>
            <button class="button" type="submit">Search</button>
          </form>
        </div>
      </div>
    </header>

  <!--main body-->
    <main>
       
        <h1>Checkout</h1>
      
        <section id="order-details">
          <h2>Order Details</h2>
          <table class="table2">
            <thead>
              <tr>
                <th>Item</th>
                <th>Price</th>
              </tr>
            </thead>
            <tbody id="order-items"></tbody>
            <tfoot>
              <tr>
                <td>Delivery Charge:</td>
                <td id="delivery-charge">₹ 40</td>
              </tr>
              <tr>
                <td>Taxes:</td>
                <td id="taxes">₹ 0</td>
              </tr>
              <tr>
                <td>Discount:</td>
                <td id="discount">₹ 0</td>
              </tr>
              <tr>
                <td>Total:</td>
                <td id="total">₹ 0</td>
              </tr>
            </tfoot>
          </table>
        </section>
      
        <section id="payment-method">
          <h2>Payment Method</h2>
          <form action="">
          <div id="payment-options">
            <div>
              <input type="radio" id="paytm" name="payment" value="paytm">
              <label for="paytm">Paytm</label>
            </div>
            <div>
              <input type="radio" id="phonepe" name="payment" value="phonepe">
              <label for="phonepe">PhonePe</label>
            </div>
            <div>
              <input type="radio" id="upi" name="payment" value="upi">
              <label for="upi">UPI ID</label>
            </div>
          </div>
          <input type="text" id="upi-id" placeholder="Enter UPI ID" style="display: none;">
          
        </form>
        </section>
        <button id="place-order" class="button3" onclick="placeOrder()">Place Order</button>
      
    </main>

<!--footer-->
    <footer
      class="primary-footer padding-block-700 bg-neutral-900 text-neutral-100"
    >
      <div class="container">
        <div class="primary-footer-wrapper even-columns">
          <div class="primary-footer-logo-social">
            <a class="logo-footer" href="#" aria-label="home"> Bite Mate </a>
            <ul class="social-list" role="list" id = "about" aria-label="social links">
              <li>
                <a aria-label="facebook" href="#">
                  <svg class="social-icon">
                    <use
                      xlink:href="images/social-icons.svg#icon-facebook"
                    ></use>
                  </svg>
                </a>
              </li>
              <li>
                <a aria-label="youtube" href="#">
                  <svg class="social-icon">
                    <use
                      xlink:href="images/social-icons.svg#icon-youtube"
                    ></use>
                  </svg>
                </a>
              </li>
              <li>
                <a aria-label="twitter" href="#"
                  ><svg class="social-icon">
                    <use
                      xlink:href="images/social-icons.svg#icon-twitter"
                    ></use></svg>
                </a>
              </li>
              <li>
                <a aria-label="pinterest" href="#">
                  <svg class="social-icon">
                    <use
                      xlink:href="images/social-icons.svg#icon-pinterest"
                    ></use>
                  </svg>
                </a>
              </li>
              <li>
                <a aria-label="instagram" href="#">
                  <svg class="social-icon">
                    <use
                      xlink:href="images/social-icons.svg#icon-instagram"
                    ></use>
                  </svg>
                </a>
              </li>
            </ul>
          </div>
          <div class="primary-footer-nav">
            <nav class="footer-nav">
              <ul
                class="flow"
                style="--flow-spacer: 1em"
                role="list"
                aria-label="footer"
              >
                <li><a href="#">Home</a></li>
                <li><a href="#">Restaurants</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="#">Profile</a></li>
              </ul>
            </nav>
          </div>
          <div class="primary-footer-form">
            <form action="">
              <input id = "contact" class="form-header" type="email" placeholder="Email" />
              <button class="button">Go</button>
            </form>
            <p>Copyright 2023. All rights reserved</p>
          </div>
        </div>
      </div>

    </footer>
<script>
const urlParams = new URLSearchParams(window.location.search);
const totalPrice = urlParams.get('totalPrice');
const cartItemsData = JSON.parse(urlParams.get('cartItems'));

// Function to format price in rupees
function formatPrice(price) {
  return `₹ ${price}`;
}

// Function to calculate and update the order total
function updateOrderTotal() {
  const subTotal = cartItemsData.reduce((total, item) => total + item.price, 0);
  const deliveryCharge = 40;
  const taxes = Math.round(subTotal * 0.1);
  const discount = 0;
  const total = subTotal + deliveryCharge + taxes - discount;

  // Update the DOM elements with calculated values
  document.getElementById('sub-total').textContent = formatPrice(subTotal);
  document.getElementById('taxes').textContent = formatPrice(taxes);
  document.getElementById('discount').textContent = formatPrice(discount);
  document.getElementById('total').textContent = formatPrice(total);
}


function displayOrderItems() {
  const orderItemsContainer = document.getElementById('order-items');
  cartItemsData.forEach(item => {
    const row = document.createElement('tr');

    const itemName = document.createElement('td');
    itemName.textContent = item.name;
    row.appendChild(itemName);

    const itemPrice = document.createElement('td');
    itemPrice.textContent = formatPrice(item.price);
    row.appendChild(itemPrice);

    orderItemsContainer.appendChild(row);
  });
}

function placeOrder() {
  const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;
  const upiId = document.getElementById('upi-id').value;

  const orderDetails = {
    totalPrice: totalPrice,
    cartItems: cartItemsData,
    deliveryCharge: 40,
    taxes: Math.round(cartItemsData.reduce((total, item) => total + item.price, 0) * 0.1),
    discount: 0,
    paymentMethod: paymentMethod,
    upiId: upiId
  };

  fetch('/place-order', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(orderDetails)
  })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        alert('Order placed successfully!');
        window.location.href = '/payment.html';
      } else {
        alert('Failed to place the order. Please try again.');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('An error occurred while placing the order. Please try again.');
    });
}

window.onload = function () {
  updateOrderTotal();
  displayOrderItems();
};

</script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T"
        crossorigin="anonymous"></script>
  </body>
</html>
